<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>For You â™¥</title>

<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600&family=Playfair+Display:wght@500&display=swap" rel="stylesheet">

<style>
:root{
  --cream:#fdf6ec;
  --gold:#d4af37;
  --gold-light:#f3e5ab;
  --text:#5a3e36;
}

body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background: radial-gradient(circle at top,#fff8ef 0%,#fdf1e6 40%,#f7e6d5 100%);
  font-family:'Cormorant Garamond', serif;
  padding:20px;
  overflow-x:hidden;
}

.wrapper{
  text-align:center;
  max-width:360px;
}

h3{
  font-family:'Playfair Display', serif;
  font-size:1.9rem;
  letter-spacing:0.08em;
  color:var(--text);
  margin-bottom:6px;
}

.subtitle{
  font-style:italic;
  color:#9c6b53;
  margin-bottom:20px;
}

.container{
  position:relative;
  width:100%;
  border-radius:22px;
  overflow:hidden;
  box-shadow:
    0 20px 40px rgba(0,0,0,0.15),
    inset 0 0 40px rgba(0,0,0,0.05);
  background:var(--cream);
}

.container img{
  width:100%;
  display:block;
  border-radius:22px;
  transition:transform 1.2s ease;
}

canvas{
  position:absolute;
  top:0;
  left:0;
  border-radius:22px;
}

.revealed img{
  transform:scale(1.05);
}

/* Floating music notes */
.music-note{
  position:fixed;
  font-size:22px;
  animation:floatUp 4s linear forwards;
  pointer-events:none;
  opacity:0.9;
}

@keyframes floatUp{
  0%{ transform:translateY(0) scale(1); opacity:1;}
  100%{ transform:translateY(-200px) scale(1.6); opacity:0;}
}
</style>
</head>

<body>

<div class="wrapper">
  <h3>Scratch to Reveal Jeeny â™¥</h3>
  <div class="subtitle">Headphone use kar lena nahi to sab sun lenge ðŸ˜Œ</div>

  <div class="container" id="card">
    <img src="./jenny1.png" id="hiddenImage">
    <canvas id="scratch"></canvas>
  </div>
</div>

<audio id="bgMusic" preload="auto">
  <source src="./abhitotum_a9m19e1791.mp3" type="audio/mpeg">
</audio>

<script>
const canvas=document.getElementById("scratch");
const ctx=canvas.getContext("2d");
const img=document.getElementById("hiddenImage");
const music=document.getElementById("bgMusic");
const card=document.getElementById("card");

let isDrawing=false;
let musicStarted=false;
let revealed=false;
let noteInterval=null;

/* SET CANVAS */
img.onload=function(){
  canvas.width=img.clientWidth;
  canvas.height=img.clientHeight;

  const gradient=ctx.createLinearGradient(0,0,canvas.width,canvas.height);
  gradient.addColorStop(0,"#f3e5ab");
  gradient.addColorStop(1,"#d4af37");
  ctx.fillStyle=gradient;
  ctx.fillRect(0,0,canvas.width,canvas.height);

  ctx.globalCompositeOperation="destination-out";
};

/* FADE IN MUSIC */
function playMusic(){
  if(!musicStarted){
    music.volume=0;
    music.play().then(()=>{
      musicStarted=true;

      let fade=setInterval(()=>{
        if(music.volume<0.9){
          music.volume+=0.05;
        }else{
          clearInterval(fade);
        }
      },200);

      startFloatingNotes();
    }).catch(()=>{});
  }
}

/* FLOATING EMOJIS */
function startFloatingNotes(){
  if(noteInterval) return;
  noteInterval=setInterval(createMusicNote,800);
}

function createMusicNote(){
  const note=document.createElement("div");
  note.classList.add("music-note");

  const emojis=["ðŸŽµ","ðŸŽ¶","ðŸ’–","âœ¨"];
  note.innerText=emojis[Math.floor(Math.random()*emojis.length)];

  note.style.left=Math.random()*90+"%";
  note.style.bottom="40px";

  document.body.appendChild(note);
  setTimeout(()=>note.remove(),4000);
}

/* SCRATCH LOGIC */
function getXY(e){
  const rect=canvas.getBoundingClientRect();
  return{
    x:(e.touches?e.touches[0].clientX:e.clientX)-rect.left,
    y:(e.touches?e.touches[0].clientY:e.clientY)-rect.top
  };
}

function start(){
  isDrawing=true;
}

function end(){
  isDrawing=false;
  ctx.beginPath();
}

function draw(e){
  if(!isDrawing) return;
  e.preventDefault();

  const {x,y}=getXY(e);
  ctx.beginPath();
  ctx.arc(x,y,25,0,Math.PI*2);
  ctx.fill();

  checkReveal();
}

/* CHECK SCRATCH % */
function checkReveal(){
  const pixels=ctx.getImageData(0,0,canvas.width,canvas.height);
  let transparent=0;

  for(let i=3;i<pixels.data.length;i+=4){
    if(pixels.data[i]===0) transparent++;
  }

  let percent=Math.floor((transparent/(pixels.data.length/4))*100);

  if(percent>30 && !musicStarted){
    playMusic();
  }

  if(percent>45 && !revealed){
    revealed=true;
    card.classList.add("revealed");
  }
}

canvas.addEventListener("mousedown",start);
canvas.addEventListener("mouseup",end);
canvas.addEventListener("mousemove",draw);

canvas.addEventListener("touchstart",start);
canvas.addEventListener("touchend",end);
canvas.addEventListener("touchmove",draw);
</script>

</body>
</html>